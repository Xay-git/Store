<% layout("/common/_container.html"){ %><style>    .user-info-head {        width: 110px;        height: 110px;        position: relative;        display: inline-block;    }    .user-info-head:hover:after {        content: '\e65d';        position: absolute;        left: 0;        right: 0;        top: 0;        bottom: 0;        color: #eee;        background: rgba(0, 0, 0, 0.5);        font-family: layui-icon;        font-size: 24px;        font-style: normal;        -webkit-font-smoothing: antialiased;        -moz-osx-font-smoothing: grayscale;        cursor: pointer;        line-height: 110px;        border-radius: 50%;    }    .user-info-head img {        width: 110px;        height: 110px;        border-radius: 50%;    }</style><div class="layui-body-header">    <span class="layui-body-header-title">添加</span></div><div class="layui-fluid">    <div class="layui-card">        <div id="memberapp" class="layui-card-body" style="padding:80px 80px    20px 80px;">            <form id="memberForm" lay-filter="memberForm" class="layui-form model-form">                <div class="layui-row layui-col-space15">                    <div class="layui-col-md2">                        <div class="text-center layui-text">                            <div class="user-info-head" id="imgHead">                                <img id="avatarPreview" src="/common/images/default.jpg">                            </div>                            <input id="avatar" type="hidden" name="avatar">                            <h3 style="padding-top:30px;color: #666666;">设置头像</h3>                        </div>                    </div>                    <div class="layui-col-md5">                        <input type="hidden" name="id">                        <div class="layui-form-item">                            <label class="layui-form-label">姓名<span style="color: red;">*</span> </label>                            <div class="layui-input-block">                                <input id="name" name="name" placeholder="请输入姓名" type="text" class="layui-input" lay-verify="required|" />                            </div>                        </div>                        <div class="layui-form-item">                            <label class="layui-form-label">手机号<span style="color: red;">*</span> </label>                            <div class="layui-input-block">                                <input id="phoneNumber" name="phoneNumber" placeholder="请输入手机号" type="text" class="layui-input" lay-verify="required|phone|" />                            </div>                        </div>                        <div class="layui-form-item">                            <label class="layui-form-label">性别</label>                            <div class="layui-input-block">                                <input type="radio" name="sex" value="1" title="男" checked>                                <input type="radio" name="sex" value="2" title="女">                            </div>                        </div>                        <div class="layui-form-item">                            <label class="layui-form-label">出生年月</label>                            <div class="layui-input-block">                                <input id="birthday" name="birthday" readonly="readonly" placeholder="请输入出生年月"  autocomplete="off" type="text" class="layui-input" lay-verify=""  lay-key="3">                            </div>                        </div>                        <div class="layui-form-item">                            <label class="layui-form-label">客户来源</label>                            <div class="layui-input-block">                                <el-select v-model="data.comeFrom" >                                    <el-option                                            v-for="item in comeFromDic"                                            :key="item.dictId"                                            :label="item.name"                                            :value="item.dictId"                                    >                                    </el-option>                                </el-select>                                <input type="hidden" name="comeFrom" v-model="data.comeFrom">                            </div>                        </div>                        <div class="layui-form-item">                            <label class="layui-form-label">家庭住址</label>                            <div class="layui-input-block">                                <textarea name="address" placeholder="请输入家庭住址" class="layui-textarea" lay-verify=""></textarea>                            </div>                        </div>                    </div>                    <div class="layui-col-md5">                        <div class="layui-form-item">                            <label class="layui-form-label">所属门店</label>                            <div class="layui-input-block">                                <el-select  v-model="data.deptId" >                                    <el-option                                            v-for="item in deptList"                                            :key="item.deptId"                                            :label="item.deptName"                                            :value="item.deptId"                                    >                                    </el-option>                                </el-select>                                <input type="hidden" name="deptId" v-model="data.deptId">                            </div>                        </div>                        <div class="layui-form-item">                            <label class="layui-form-label">短信提醒</label>                            <div class="layui-input-block">                                <input type="checkbox" name="smsAlert"  checked  lay-skin="switch" lay-text="开启|关闭">                            </div>                        </div>                        <div class="layui-form-item">                            <label class="layui-form-label">备注</label>                            <div class="layui-input-block">                                <textarea name="remark" placeholder="请输入备注" class="layui-textarea" lay-verify=""></textarea>                            </div>                        </div>                    </div>                </div>                <div class="layui-form-item" style="margin: 60px auto;">                    <div class="layui-input-block" style="text-align: center;">                        <button class="layui-btn" lay-filter="btnSubmit" type="button"  lay-submit>&emsp;提交&emsp;</button>                        <button class="layui-btn" lay-filter="btnSubmit" type="button" data-submit="charged" lay-submit>提交并充值</button>                        <button class="layui-btn layui-btn-primary" type="button" @click="back">&emsp;返回&emsp;</button>                    </div>                </div>            </form>        </div>    </div></div><script>    var form = layui.form;    var $ = layui.jquery;    var upload = layui.upload;    var PREFIX = '/admin/member';    var vm = new Vue({        el:'#memberapp',        data:{            msg:'Hello World!',            deptList:'',            comeFromDic:'',            data:{                deptId:'',                comeFrom:api.dictDetail.comfrom            },            loginUser:''        },        methods:{            getDetail:async function(id){                vm.data = await request.fetch(PREFIX + '/getMemberDetail',{id:id});                form.val('memberForm',vm.data);            },            onload:async function () {                 this.loginUser = await api.getLoginUser();                 this.deptList = await api.getDeptList();                 this.comeFromDic = await api.getDictDetail(api.dict.comefrom);                 if(app.isEmpty(this.data.deptId)){                     this.data.deptId = this.loginUser.deptId;                 }            },            back:function () {                app.go(PREFIX+'/member_list')            }        },        mounted:async function() {            //在模板渲染成html后调用，通常是初始化页面完成后，再对html的dom节点进行一些需要的操作。            vm = this;            await vm.onload();            var id = app.getUrlParam('id');            app.isNotEmpty(id) && await vm.getDetail(id);            //表单提交事件            form.on('submit(btnSubmit)', function (data) {                console.log(data.field)                var dataSet = data.elem.dataset.submit;                console.log(dataSet)                request.post(PREFIX+'/editMember',data.field).then(res => {                    app.success("操作成功！",function () {                        if (dataSet == 'charged') {                        }else{                            vm.back();                        }                    })                })               return false;            })            laydate.render({                elem: '#birthday'            });            form.render();        },        updated: function () {            form.render();        },        watch:{        }    });</script><% } %>